<?xml version="1.0"?>
<robot name="simple_humanoid_arm_extended">
  <!-- Base/shoulder link with enhanced visual and collision properties -->
  <link name="shoulder_link">
    <inertial>
      <mass value="2.0"/>
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
      <geometry>
        <!-- Using a more complex mesh for visual representation -->
        <mesh filename="package://my_robot_description/meshes/shoulder_link.dae" scale="1 1 1"/>
      </geometry>
      <material name="dark_gray">
        <color rgba="0.3 0.3 0.3 1"/>
      </material>
    </visual>
    <collision>
      <!-- Using multiple collision elements for more accurate collision detection -->
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
      <geometry>
        <cylinder length="0.2" radius="0.06"/>
      </geometry>
    </collision>
    <!-- Additional collision elements for complex shape -->
    <collision>
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
      <geometry>
        <sphere radius="0.06"/>
      </geometry>
    </collision>
  </link>

  <!-- Shoulder joint with enhanced properties -->
  <joint name="shoulder_joint" type="revolute">
    <parent link="shoulder_link"/>
    <child link="upper_arm_link"/>
    <origin xyz="0 0 0.2" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-2.094" upper="1.571" effort="200" velocity="2.0"/>
    <dynamics damping="1.0" friction="0.5"/>
    <!-- Safety limits to prevent self-collision -->
    <safety_controller k_position="10" k_velocity="1.0" soft_lower_limit="-2.0" soft_upper_limit="1.5"/>
  </joint>

  <!-- Upper arm link with enhanced visual and collision properties -->
  <link name="upper_arm_link">
    <inertial>
      <mass value="1.5"/>
      <origin xyz="0 0 0.15" rpy="0 0 0"/>
      <inertia ixx="0.02" ixy="0.0" ixz="0.0" iyy="0.02" iyz="0.0" izz="0.005"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.15" rpy="0 0 0"/>
      <geometry>
        <!-- Using a mesh file for more realistic visual appearance -->
        <mesh filename="package://my_robot_description/meshes/upper_arm_link.dae" scale="1 1 1"/>
      </geometry>
      <material name="light_gray">
        <color rgba="0.7 0.7 0.7 1"/>
      </material>
    </visual>
    <collision>
      <!-- Using a more complex collision geometry -->
      <origin xyz="0 0 0.15" rpy="0 0 0"/>
      <geometry>
        <capsule length="0.25" radius="0.045"/>
      </geometry>
    </collision>
  </link>

  <!-- Elbow joint with enhanced properties -->
  <joint name="elbow_joint" type="revolute">
    <parent link="upper_arm_link"/>
    <child link="forearm_link"/>
    <origin xyz="0 0 0.3" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-2.36" upper="2.36" effort="150" velocity="1.5"/>
    <dynamics damping="0.8" friction="0.3"/>
    <safety_controller k_position="10" k_velocity="1.0" soft_lower_limit="-2.3" soft_upper_limit="2.3"/>
  </joint>

  <!-- Forearm link with enhanced visual and collision properties -->
  <link name="forearm_link">
    <inertial>
      <mass value="1.0"/>
      <origin xyz="0 0 0.12" rpy="0 0 0"/>
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.003"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.12" rpy="0 0 0"/>
      <geometry>
        <!-- Using a mesh file for more realistic visual appearance -->
        <mesh filename="package://my_robot_description/meshes/forearm_link.dae" scale="1 1 1"/>
      </geometry>
      <material name="medium_gray">
        <color rgba="0.5 0.5 0.5 1"/>
      </material>
    </visual>
    <collision>
      <!-- Using multiple collision elements for more accurate collision detection -->
      <origin xyz="0 0 0.12" rpy="0 0 0"/>
      <geometry>
        <capsule length="0.19" radius="0.04"/>
      </geometry>
    </collision>
    <!-- Additional collision element for the elbow area -->
    <collision>
      <origin xyz="0 0 0.02" rpy="0 0 0"/>
      <geometry>
        <sphere radius="0.045"/>
      </geometry>
    </collision>
  </link>

  <!-- Wrist joint with enhanced properties -->
  <joint name="wrist_joint" type="revolute">
    <parent link="forearm_link"/>
    <child link="wrist_link"/>
    <origin xyz="0 0 0.24" rpy="0 0 0"/>
    <axis xyz="1 0 0"/>
    <limit lower="-3.14" upper="3.14" effort="50" velocity="2.5"/>
    <dynamics damping="0.5" friction="0.2"/>
  </joint>

  <!-- Wrist link with enhanced properties -->
  <link name="wrist_link">
    <inertial>
      <mass value="0.3"/>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <inertia ixx="0.0005" ixy="0.0" ixz="0.0" iyy="0.0005" iyz="0.0" izz="0.0005"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://my_robot_description/meshes/wrist_link.dae" scale="1 1 1"/>
      </geometry>
      <material name="light_gray">
        <color rgba="0.7 0.7 0.7 1"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <geometry>
        <cylinder length="0.02" radius="0.03"/>
      </geometry>
    </collision>
  </link>

  <!-- Gripper joint (for potential gripper attachment) -->
  <joint name="gripper_joint" type="fixed">
    <parent link="wrist_link"/>
    <child link="gripper_base"/>
    <origin xyz="0 0 0.02" rpy="0 0 0"/>
  </joint>

  <!-- Gripper base link -->
  <link name="gripper_base">
    <inertial>
      <mass value="0.1"/>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <inertia ixx="0.0001" ixy="0.0" ixz="0.0" iyy="0.0001" iyz="0.0" izz="0.0001"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <geometry>
        <box size="0.04 0.02 0.02"/>
      </geometry>
      <material name="red">
        <color rgba="1 0 0 1"/>
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <geometry>
        <box size="0.04 0.02 0.02"/>
      </geometry>
    </collision>
  </link>

  <!-- Define the base of the robot that connects to the rest of the humanoid -->
  <joint name="base_fixed_joint" type="fixed">
    <parent link="world"/>
    <child link="shoulder_link"/>
    <origin xyz="0 0 1.0" rpy="0 0 0"/>
  </joint>

  <!-- Virtual world link for connection reference -->
  <link name="world"/>

  <!-- Gazebo-specific properties for simulation -->
  <gazebo reference="shoulder_link">
    <material>Gazebo/Gray</material>
    <mu1>0.2</mu1>
    <mu2>0.2</mu2>
    <kp>1000000.0</kp>
    <kd>1.0</kd>
  </gazebo>

  <gazebo reference="upper_arm_link">
    <material>Gazebo/LightGray</material>
    <mu1>0.2</mu1>
    <mu2>0.2</mu2>
    <kp>1000000.0</kp>
    <kd>1.0</kd>
  </gazebo>

  <gazebo reference="forearm_link">
    <material>Gazebo/Gray</material>
    <mu1>0.2</mu1>
    <mu2>0.2</mu2>
    <kp>1000000.0</kp>
    <kd>1.0</kd>
  </gazebo>

  <gazebo reference="wrist_link">
    <material>Gazebo/LightGray</material>
    <mu1>0.2</mu1>
    <mu2>0.2</mu2>
    <kp>1000000.0</kp>
    <kd>1.0</kd>
  </gazebo>

  <gazebo reference="gripper_base">
    <material>Gazebo/Red</material>
    <mu1>0.5</mu1>
    <mu2>0.5</mu2>
    <kp>1000000.0</kp>
    <kd>1.0</kd>
  </gazebo>
</robot>